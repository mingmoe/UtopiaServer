# 构建并测试
name: CMake Build And Test

# 设置触发器
on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  # 在linux下构建
  linux-build:
    # 使用最新ubuntu镜像
    runs-on: ubuntu-latest

    steps:
    # 签出代码
    - uses: actions/checkout@v2

    # 执行构建脚本
    - name: build on linux
      run: python ./build.py debug test
    
   
  # 在mac下构建
  mac-build:
    # 使用最新macos镜像
    runs-on: macos-latest

    steps:
    # 签出代码
    - uses: actions/checkout@v2

    # 执行构建脚本
    - name: build on macos
      run: python ./build.py debug test


  # 在Windows下构建
  windows-build:
    # 使用最新windows镜像
    runs-on: windows-latest

    steps:
    # 签出代码
    - uses: actions/checkout@v2

    # 执行构建脚本
    - name: build on windows
      run: pwsh ./setup_msvc.ps1 debug test
